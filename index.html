<!DOCTYPE HTML>
<html>
  <head>
    <title>POSH Training Portal</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />

    <style>
      /* Popup modal */
      .modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.6);
      }

      .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 30px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      }

      .modal-content h3 {
        margin-bottom: 15px;
        color: #003366;
      }

      .copy-btn {
        background: #007BFF;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-top: 10px;
      }
      .copy-btn:hover {
        background: #0056b3;
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

      <!-- Main -->
      <div id="main">
        <div class="inner">

          <!-- Header -->
          <header id="header">
            <a href="index.html" class="logo"><strong>POSH</strong> Training Portal</a>
          </header>

          <!-- Hero Banner -->
          <section id="banner">
            <div class="content">
              <header>
                <h1>POSH Training Portal</h1>
                <p>Ensuring Respectful Workplaces</p>
              </header>
              <p>Verify your shop details and proceed through the steps to access the training modules.</p>
            </div>
            <span class="image object">
              <img src="images/pic10.jpg" alt="" />
            </span>
          </section>

          <!-- Steps Content -->
          <section>
            <!-- Step 1 -->
            <div id="details-section">
              <header class="major">
                <h2>Step 1: Verify Your Details</h2>
              </header>
              <p id="shop-details"></p>
              <p><strong>Are the above details correct?</strong></p>
              <p style="color:#555;">क्या यह जानकारी सही है?</p>
              <ul class="actions">
                <li><a href="#" class="button" id="confirm-btn">Yes, I Confirm</a></li>
              </ul>
            </div>

            <!-- Step 2 -->
            <div id="confirmation-section" class="hidden">
              <header class="major">
                <h2>Step 2: Your Password</h2>
              </header>
              <p id="confirmation-msg"></p>
              <div class="box">
                <p><strong>Password:</strong> <span id="shop-id"></span></p>
              </div>
              <ul class="actions">
                <li><a href="#" class="button" id="go-to-links-btn">Proceed to Training</a></li>
              </ul>
            </div>

            <!-- Step 3 -->
            <div id="final-section" class="hidden">
              <header class="major">
                <h2>Step 3: Choose Your Training</h2>
              </header>
              <div class="features">
                <article>
                  <div class="content">
                    <h3>Owner/Manager Training</h3>
                    <ul class="actions">
                      <li><a href="#" class="button" id="btn-employer">Start Employer Training</a></li>
                    </ul>
                  </div>
                </article>
                <article>
                  <div class="content">
                    <h3>Employee Training</h3>
                    <ul class="actions">
                      <li><a href="#" class="button primary" id="btn-employee">Start Employee Training</a></li>
                    </ul>
                  </div>
                </article>
              </div>
            </div>
          </section>
        </div>
      </div>

      <!-- Sidebar -->
      <div id="sidebar">
        <div class="inner">
          <nav id="menu">
            <header class="major">
              <h2>Menu</h2>
            </header>
            <ul>
              <li><a href="index.html">Homepage</a></li>
              <li><a href="noindex107.html">POSH Portal</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Popup Modal -->
    <div id="passwordModal" class="modal">
      <div class="modal-content">
        <h3>Your Password</h3>
        <p><span id="popup-password"></span></p>
        <button class="copy-btn" onclick="copyPassword()">Copy Password</button>
        <p id="copy-msg" style="color:green; display:none; margin-top:10px;">Password copied!</p>
      </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- POSH Script -->
    <script>
      const shopData = [
        { shopid: 101, shopname: "FABINDIA", marketname: "KHAN MARKET" },
        { shopid: 102, shopname: "BLUE TOKAI", marketname: "RAJOURI GARDEN" },
        { shopid: 103, shopname: "SHOPPE", marketname: "HAUZ KHAS VILLAGE" },
        { shopid: 104, shopname: "NAPPA DORI", marketname: "VASANT VIHAR" },
        { shopid: 105, shopname: "HALDIRAMS", marketname: "NEW FRIENDS COLONY" }
      ];

      const SHEET_URL = "https://script.google.com/macros/s/AKfycbwE1pMUQ61CwBDXCA_q98YUm_34Uy9oNJQ8I_XBO4VAtUNAuB2EJOZ62h3UPVRs_hfHKw/exec";

      function trackUserDetails(shopid, shopname, marketname, role) {
        fetch(SHEET_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ shopid, shopname, marketname, role, timestamp: new Date().toISOString() })
        });
        console.log("Logging:", shopid, shopname, marketname, role);
      }

      const params = new URLSearchParams(window.location.search);
      const shopIdFromUrl = parseInt(params.get("shopid"));
      const shopDetails = document.getElementById("shop-details");
      const confirmationMsg = document.getElementById("confirmation-msg");
      const shopIdElement = document.getElementById("shop-id");

      const detailsSection = document.getElementById("details-section");
      const confirmationSection = document.getElementById("confirmation-section");
      const finalSection = document.getElementById("final-section");

      const shop = shopData.find(shop => shop.shopid === shopIdFromUrl);
      if (shop) {
        shopDetails.innerText = `Shop: ${shop.shopname} | Market: ${shop.marketname}`;
      } else {
        shopDetails.innerText = "⚠️ Shop not found!";
      }

      // Show modal when confirming
      document.getElementById("confirm-btn").onclick = () => {
        confirmationMsg.innerText = `Confirmed: ${shop.shopname}, ${shop.marketname}`;
        shopIdElement.innerText = shop.shopid;

        // Show popup modal
        document.getElementById("popup-password").innerText = shop.shopid;
        document.getElementById("passwordModal").style.display = "block";
      };

      // Copy password and move on
      function copyPassword() {
        const password = document.getElementById("popup-password").innerText;
        navigator.clipboard.writeText(password).then(() => {
          document.getElementById("copy-msg").style.display = "block";
          setTimeout(() => {
            document.getElementById("passwordModal").style.display = "none";
            confirmationSection.classList.remove("hidden");
          }, 1200);
        });
      }

      // Step navigation
      document.getElementById("go-to-links-btn").onclick = () => {
        confirmationSection.classList.add("hidden");
        finalSection.classList.remove("hidden");
        window.scrollTo(0, document.body.scrollHeight);
      };

      // Training links
      const classroom1Link = "https://edpuzzle.com/assignments/68b1a7f9ddde8cb5f8362210/watch";
      const classroom2Link = "https://edpuzzle.com/assignments/68b1a7f9ddde8cb5f8362210/watch";

      document.getElementById("btn-employer").onclick = () => {
        trackUserDetails(shop.shopid, shop.shopname, shop.marketname, "Employer");
        window.location.href = classroom1Link;
      };
      document.getElementById("btn-employee").onclick = () => {
        trackUserDetails(shop.shopid, shop.shopname, shop.marketname, "Employee");
        window.location.href = classroom2Link;
      };
    </script>
  </body>
</html>
